<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>Deriving Stirling&#8217;s Formula | Matt Evans</title>
<link rel="shortcut icon" href="https://mtdevans.com/favicon.ico" />
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="../../.././wp-content/themes/twentyeleven-child/style.css" />
<link rel="pingback" href="https://mtdevans.com/xmlrpc.php" />
<link href='https://fonts.googleapis.com/css?family=Tangerine:700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Serif' rel='stylesheet' type='text/css'>
<!--[if lt IE 9]>
<script src="https://mtdevans.com/wp-content/themes/twentyeleven/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="Matt Evans &raquo; Feed" href="../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Matt Evans &raquo; Comments Feed" href="../../../comments/feed/index.html" />
<link rel='stylesheet' id='amr_breadcrumb-css'  href='../../.././wp-content/plugins/breadcrumb-navigation-widget/breadcrumbnoimage.css@ver=3.9.13.css' type='text/css' media='all' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://mtdevans.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../.././wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Particle in a one-dimensional box' href='../particle-in-a-one-dimensional-box.1.html' />
<link rel='next' title='Exchange of Particles Between Subsystems' href='../exchange-of-particles-between-subsystems.1.html' />

<link rel='shortlink' href='../../../index.html@p=226.html' />
		<style type="text/css">
						ol.footnotes li {list-style-type:decimal;}
						ol.footnotes{font-size:0.8em; color:#666666;}		</style>
		
<!-- All in One SEO Pack 2.1.7 by Michael Torbert of Semper Fi Web Design[-1,-1] -->
<link rel="author" href="http://105749333960895048875/" />
<meta name="description" content="How to derive Stirling's approximation, using an analogy with the Gaussian distribution. A simple clear walk-through of the maths." />

<meta name="keywords" content="stirling\'s approximation,stirling\'s formula,derivation,derive,stirling,solution,physics,statistical,matt evans" />

<link rel="canonical" href="../deriving-stirlings-formula.1.html" />
<!-- /all in one seo pack -->
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #FFFFFF; }
</style>
<style type="text/css" id="syntaxhighlighteranchor"></style>

            <script type="text/javascript">//<![CDATA[
            // Google Analytics for WordPress by Yoast v4.3.5 | http://yoast.com/wordpress/google-analytics/
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-33092385-2']);
					_gaq.push(['_trackPageLoadTime']);
            _gaq.push(['_trackPageview']);
            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
            //]]></script>
			</head>

<body class="page page-id-226 page-child parent-pageid-223 page-template-default custom-background single-author singular two-column right-sidebar">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
	    <div id="hdfltcont">
			  <hgroup>
				  <h1 id="site-title"><span><a href="../../../index.html" title="Matt Evans" rel="home">Matt Evans</a></span></h1>
				  <h2 id="site-description">(( Physics, Security, Web ))</h2>
			  </hgroup>
			  <nav id="access" role="navigation">
				  <h3 class="assistive-text">Main menu</h3>
				  				  <div class="skip-link"><a class="assistive-text" href="../deriving-stirlings-formula.1.html#content" title="Skip to primary content">Skip to primary content</a></div>
				  <div class="skip-link"><a class="assistive-text" href="../deriving-stirlings-formula.1.html#secondary" title="Skip to secondary content">Skip to secondary content</a></div>
				  				  <div class="menu"><ul><li ><a href="../../../index.html">Home</a></li><li class="page_item page-item-106 page_item_has_children current_page_ancestor"><a href="../../index.html">Projects</a><ul class='children'><li class="page_item page-item-223 page_item_has_children current_page_ancestor current_page_parent"><a href="../index.html" title="Matt Evans | Solutions to Some Common Physics Problems">Physics Problems</a><ul class='children'><li class="page_item page-item-323"><a href="../polymer-bundle-2-d-microcanonical-approach.1.html" title="2-Dimensional Polymer Bundle (Microcanonical) | Matt Evans">2-D Polymer Bundle (Microcanonical Approach)</a></li><li class="page_item page-item-286"><a href="../absorption-of-molecules-onto-a-surface.1.html">Adsorption of Molecules onto a Surface</a></li><li class="page_item page-item-226 current_page_item"><a href="../deriving-stirlings-formula.1.html" title="Matt Evans | Physics Problems | Deriving Stirling's Formula">Deriving Stirling&#8217;s Formula</a></li><li class="page_item page-item-373"><a href="../diatomic-molecule-as-rigid-rotor/index.html">Diatomic Molecule as Rigid Rotor</a></li><li class="page_item page-item-345"><a href="../diesel-cycle-efficiency.1.html" title="Diesel Cycle Efficiency | Matt Evans">Diesel Cycle Efficiency</a></li><li class="page_item page-item-280"><a href="../exchange-of-particles-between-subsystems.1.html">Exchange of Particles Between Subsystems</a></li><li class="page_item page-item-500"><a href="../fixed-target-vs-collider-experiments-with-discussion/index.html">Fixed Target vs Collider Experiments (with discussion)</a></li><li class="page_item page-item-525"><a href="../interactions-of-charged-particles-with-matter/index.html">Interactions of Charged Particles with Matter</a></li><li class="page_item page-item-490"><a href="../mandelstam-variables-with-identical-particles/index.html">Mandelstam Variables with Identical Particles</a></li><li class="page_item page-item-288"><a href="../maxwell-relations.1.html">Maxwell Relations</a></li><li class="page_item page-item-319"><a href="../mixture-of-two-ideal-gases-microcanonical-approach.1.html" title="Mixture of Two Ideal Gases (Microcanonical) | Matt Evans">Mixture of Two Ideal Gases</a></li><li class="page_item page-item-228"><a href="../particle-in-a-one-dimensional-box.1.html" title="Matt Evans | Physics Problems | Particle in 1-D Box">Particle in a one-dimensional box</a></li><li class="page_item page-item-230"><a href="../random-walk-of-two-drunks.1.html" title="Matt Evans | Physics Problems | Random Walk of Two Drunks">Random Walk of Two Drunks</a></li><li class="page_item page-item-356"><a href="../reverse-carnot-cycle-efficiency.1.html" title="Matt Evans | Efficiency of the Reverse Carnot Cycle">Reverse Carnot Cycle Efficiency</a></li><li class="page_item page-item-233"><a href="../system-of-n-harmonic-oscillators.1.html" title="Microcanonical System N Harmonic Oscillators | Matt Evans">System of N Harmonic Oscillators</a></li></ul></li><li class="page_item page-item-149"><a href="../../barcode.1.html" title="Tesco Discount Barcodes, Cracked.">Tesco Discount Barcodes, Cracked</a></li><li class="page_item page-item-122"><a href="../../zappysearch/index.html" title="ZappySearch, a Firefox Plugin">ZappySearch</a></li></ul></li><li class="page_item page-item-104 page_item_has_children"><a href="../../../about/index.html">About</a><ul class='children'><li class="page_item page-item-384"><a href="../../../about/privacy-policy.1.html">Privacy Policy</a></li></ul></li><li class="page_item page-item-205"><a href="../../../contact/index.html" title="Matt Evans | Contact">Contact</a></li></ul></div>
			  </nav><!-- #access -->
			  <br style="clear:both;">
			</div>

	</header><!-- #branding -->


	<div id="main">

		<div id="primary" class="loner">
		<ul id="breadcrumbul"><li id="breadcrumb_navigation_widget-2" class="widget crumbs"><h2 class="widgettitle"></h2>

<ul><li><a href="../../../index.html" title="Home">Home</a><span>-></span> </li><li class="page_item lvl1"><a href="../../index.html" title="Projects">Projects</a><span>-></span></li><li class="page_item lvl2"><a href="../index.html" title="Physics Problems">Physics Problems</a><span>-></span></li><li class="page_item lvl3 current_page_item"><a href="../deriving-stirlings-formula.1.html" title="Deriving Stirling&#039;s Formula">Deriving Stirling&#039;s Formula</a></li>
</ul></li>
</ul>			<div id="content" role="main">

				
					
	<article id="post-226" class="post-226 page type-page status-publish hentry">
		<header class="entry-header">
						<h1 class="entry-title"><a href="../deriving-stirlings-formula.1.html" title="Permalink to Deriving Stirling&#8217;s Formula" rel="bookmark">Deriving Stirling&#8217;s Formula</a></h1>
			
			
					</header><!-- .entry-header -->

				<div class="entry-content">
			<h2>A little background to Stirling&#8217;s Formula</h2>
<p>Stirling&#8217;s approximation is vital to a manageable formulation of statistical physics and thermodynamics. It vastly simplifies calculations involving logarithms of factorials where the factorial is huge. In statistical physics, we are typically discussing systems of <script type="math/tex">10^{22}</script> particles. With numbers of such orders of magnitude, this approximation is certainly valid, and also proves incredibly useful.</p>
<p>There are numerous ways of deriving the result, and further refinements to the approximation to be found elsewhere. Here is a simple derivation using an analogy with the Gaussian distribution:</p>
<h2>The Formula</h2>
<p>Derive the Stirling formula: $$\ln(n!) \approx (n+\frac{1}{2})\ln{n} &#8211; n + \frac{1}{2}\ln{2\pi}$$</p>
<h2>Let&#8217;s Go</h2>
<p>We begin by calculating the integral <script type="math/tex">\int_{0}^{\infty} e^{-x} x^n dx</script> (where <script type="math/tex">n \ge 0</script>) using <a href="http://en.wikipedia.org/wiki/Integration_by_parts" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://en.wikipedia.org/wiki/Integration_by_parts']);" title="Integration by parts">integration by parts</a>.</p>
<p>The formula for integration by parts is: $$\int u(x)v´(x)dx=u(x)v(x)-\int u´(x)v(x)dx$$</p>
<p>Given this situation, it&#8217;s normally better to take the infinitely differentiable function as your <script type="math/tex">v´(x)</script>:</p>
<p>\(u(x)=x^n\) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \(u&#8217;(x)=nx^{n-1}\)<br />
\(v(x)=-e^{-x}\) &nbsp;&nbsp;&nbsp; \(v&#8217;(x)=e^{-x}\)</p>
<p>Thus we have: \begin{equation}\int_{0}^{\infty} x^ne^{-x}dx=[x^n·-e^{-x}]_{0}^{\infty} + n\int_{0}^{\infty}x^{n-1}·e^{-x}dx\label{eq:int1}\end{equation}</p>
<p>We note that <script type="math/tex">[x^n·-e^{-x}]_{0}^{\infty}</script> is always zero. Labelling the first integral \(g(x)\), the last integral is nothing more than <script type="math/tex">n·g(x)|_{n \rightarrow n-1}</script>. This can be integrated by parts to yield a similar expression but with <script type="math/tex">n</script> reduced to <script type="math/tex">n-1</script> (and so on) such that we end up with <script type="math/tex">n·(n-1)·(n-2)·...·(1)=n!</script>.</p>
<p>\begin{equation}<br />
\int_{0}^{\infty} x^ne^{-x}dx=n! \label{eq:eqeq}<br />
\end{equation}</p>
<p>Take the logarithm of the integrand in \eqref{eq:int1}: $$\ln{e^{-x}x^n} = -x + n\ln{x} =: f(x)$$ $$f&#8217;(x) \stackrel{!}{=} 0 = -1 + \frac{n}{x}$$ $$\Rightarrow x_0=n$$</p>
<p>So we find it has a maximum at <script type="math/tex">x_0=n</script>. <a href="http://en.wikipedia.org/wiki/Taylor_expansion" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://en.wikipedia.org/wiki/Taylor_expansion']);" title="Taylor expansion">Expanding</a> <script type="math/tex">f(x)</script> around <script type="math/tex">n</script>: $$f(x)=-n+n \ln{n}+(-1+\frac{n}{x})|_{x=n}(x-n) + \frac{1}{2!} (\frac{-n}{x^2})|_{x=n}(x-n)^2 + &#8230;$$ $$=-n+n\ln{n}-\frac{1}{2n}(x-n)^2$$</p>
<p>Therefore, <script type="math/tex">f(x)=\ln e^{-x} x^n \approx -n  + n\ln n - \frac{1}{2n}(x-n)^2</script>.</p>
<p>If we take the exponential of <script type="math/tex">f(x)</script> and integrate, we see we have the same integral we just calculated in \eqref{eq:int1} but in a more useful form: $$\int \exp(f(x))dx=\int e^{-x}x^ndx$$ $$\simeq\int \exp(-n + n\ln{n} &#8211; \frac{1}{2n}(x-n)^2)\,dx$$ \begin{equation}<br />
  =\exp(-n+n\ln{n})\int_{0}^{\infty} \exp(-\frac{(x-n)^2}{2n})dx \stackrel{\eqref{eq:eqeq}}{=} n!<br />
  \label{eq:nbang}<br />
\end{equation}</p>
<p>This is calculable by analogy with the <a href="http://en.wikipedia.org/wiki/Gaussian_distribution" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://en.wikipedia.org/wiki/Gaussian_distribution']);" title="Gaussian distribution">Gaussian distribution</a>, where $$P(x)=\frac{1}{\sqrt{2\pi}\sigma}\exp(-\frac{(x-\stackrel{-}{x})^2}{2\sigma^2}).$$</p>
<p>Given the sum of all probabilities <script type="math/tex">\int_{-\infty}^{\infty} P(x)dx = 1</script>, it follows $$\sqrt{2\pi}\sigma = \int_{-\infty}^{\infty} \exp(-\frac{(x-\stackrel{-}{x})^2}{2\sigma^2})dx.$$</p>
<p>If we compare this with \eqref{eq:nbang}, we note <script type="math/tex">\sigma^2</script> and <script type="math/tex">\stackrel{-}{x}</script> both translate to <script type="math/tex">n</script> in our analogy: </p>
<p>$$n!\simeq\exp(-n+n\ln{n})\int_{0}^{\infty} \exp(-\frac{(x-n)^2}{2n})\,dx$$</p>
<p>\begin{equation}= \exp(-n+n\ln{n})\sqrt{2\pi n} \label{eq:final}\end{equation}</p>
<p>Note that the lower bound on the integral has changed from <script type="math/tex">-\infty</script> to 0. This approximation is justifiable since the peak of the distribution <script type="math/tex">n</script> is at a point much greater than zero, thus most of the distribution is greater than zero.</p>
<p>Finally, taking the logarithm of \eqref{eq:final}, $$\ln{n!} \simeq -n + n\ln{n} + \frac{1}{2}\ln{2\pi n}$$ $$=(n+\frac{1}{2})\ln{n}-n+\frac{1}{2}\ln{2\pi},$$</p>
<p>we recover what we started with.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
						
			
					</footer><!-- #entry-meta -->
	</article><!-- #post-226 -->

						<div id="comments">
	
	
	
			
</div><!-- #comments -->

				
			</div><!-- #content -->
		</div><!-- #primary -->


		<div id="secondary" class="widget-area" role="complementary">
			<aside id="search-2" class="widget widget_search">	<form method="get" id="searchform" action="../../../index.html">
		<label for="s" class="assistive-text">Search</label>
		<input type="text" class="field" name="s" id="s" placeholder="Search" />
		<input type="submit" class="submit" name="submit" id="searchsubmit" value="Search" />
	</form>
</aside><aside id="text-2" class="widget widget_text"><h3 class="widget-title">About Me</h3>			<div class="textwidget"><p>Hello and welcome! I'm Matt Evans, a Physics student at the University of Manchester with an unhealthy interest in technology, software, security, and the web.</p>
<p>I don't hang out here <em>too</em> much at the moment, but <a href="../../index.html" title="A list of the projects I'm currently involved with">any projects</a> I'm working on are kept up to date - both Physics- and web-related.</p>
</div>
		</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-17"><a href="../../../category/general/index.html" title="Posts which don&#039;t fit into any other category">General</a>
</li>
	<li class="cat-item cat-item-21"><a href="../../../category/physics/index.html" title="View all posts filed under Physics">Physics</a>
</li>
	<li class="cat-item cat-item-28"><a href="../../../category/security/index.html" title="View all posts filed under Security">Security</a>
</li>
	<li class="cat-item cat-item-11"><a href="../../../category/technology/index.html" title="My thoughts on and experience in the world of technology.">Technology</a>
</li>
	<li class="cat-item cat-item-22"><a href="../../../category/web/index.html" title="View all posts filed under Web">Web</a>
</li>
		</ul>
</aside><aside id="tag_cloud-2" class="widget widget_tag_cloud"><h3 class="widget-title">Tags</h3><div class="tagcloud"><a href='../../../tag/about-me/index.html' class='tag-link-20' title='1 topic' style='font-size: 8pt;'>About Me</a>
<a href='../../../tag/cakephp/index.html' class='tag-link-19' title='1 topic' style='font-size: 8pt;'>CakePHP</a>
<a href='../../../tag/javascript/index.html' class='tag-link-27' title='3 topics' style='font-size: 15.636363636364pt;'>JavaScript</a>
<a href='../../../tag/particle-physics/index.html' class='tag-link-31' title='1 topic' style='font-size: 8pt;'>particle physics</a>
<a href='../../../tag/passwords/index.html' class='tag-link-30' title='1 topic' style='font-size: 8pt;'>passwords</a>
<a href='../../../tag/physics/index.html' class='tag-link-21' title='6 topics' style='font-size: 22pt;'>Physics</a>
<a href='../../../tag/search/index.html' class='tag-link-14' title='1 topic' style='font-size: 8pt;'>search</a>
<a href='../../../tag/security-2/index.html' class='tag-link-29' title='1 topic' style='font-size: 8pt;'>security</a>
<a href='../../../tag/solved-problems/index.html' class='tag-link-16' title='2 topics' style='font-size: 12.581818181818pt;'>solved problems</a>
<a href='../../../tag/tutorial/index.html' class='tag-link-24' title='2 topics' style='font-size: 12.581818181818pt;'>Tutorial</a>
<a href='../../../tag/virtualbox/index.html' class='tag-link-25' title='1 topic' style='font-size: 8pt;'>VirtualBox</a>
<a href='../../../tag/virtualization/index.html' class='tag-link-26' title='1 topic' style='font-size: 8pt;'>Virtualization</a>
<a href='../../../tag/web-development/index.html' class='tag-link-23' title='1 topic' style='font-size: 8pt;'>Web Development</a>
<a href='../../../tag/welcome/index.html' class='tag-link-18' title='1 topic' style='font-size: 8pt;'>welcome</a>
<a href='../../../tag/wordpress/index.html' class='tag-link-8' title='2 topics' style='font-size: 12.581818181818pt;'>Wordpress</a></div>
</aside>		</div><!-- #secondary .widget-area -->

	</div><!-- #main -->

	<footer id="colophon" role="contentinfo">

			

      <div id="copyrightinfo">
        &copy; Copyright Matt Evans 2014 - <a href="../../../about/privacy-policy.1.html" title="How I protect you and your data.">Privacy</a>
      </div>
		  <div id="social_icons">
		    <a href="https://www.facebook.com/mtdevans" title="Find me on Facebook" class="fb"></a>
		    <a href="https://twitter.com/mtdevans" title="Follow me on Twitter" class="tt"></a>
		    <a href="https://plus.google.com/105749333960895048875/?rel=author" title="Circle me on Plus" class="plus"></a>
		    <a href="https://www.linkedin.com/mtdevans" title="Connect with me on LinkedIn" class="li"></a>
		  </div>
			<div id="site-generator">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Proudly powered by WordPress</a>
			</div>
			<br class="clear">
	</footer><!-- #colophon -->
</div><!-- #page -->


<script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML-full"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}});</script>

<script type='text/javascript' src='../../.././wp-includes/js/comment-reply.min.js@ver=3.9.13'></script>

</body>
</html>

<!-- Dynamic page generated in 0.091 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2016-07-26 03:02:29 -->

<!-- Compression = gzip -->
<!-- super cache -->