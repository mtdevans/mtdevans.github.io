<!doctype html>
<html lang="en-uk">
  <head>
    <title>Deriving Stirlings Formula // Matt Evans</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="preconnect" href="https://region1.google-analytics.com">

    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.110.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.aaed4da8694f0a49afef557734c8c9109faf4d15ec9b6870ed067abca0fd4fce.css" />

    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DD1WTT1JY0"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-DD1WTT1JY0', { 'anonymize_ip': false });
}
</script>

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deriving Stirlings Formula"/>
<meta name="twitter:description" content="## A little background to Stirling’s Formula ##
Stirling’s approximation is vital to a manageable formulation of statistical physics and thermodynamics. It vastly simplifies calculations involving logarithms of factorials where the factorial is huge. In statistical physics, we are typically discussing systems of \(10^{22}\) particles. With numbers of such orders of magnitude, this approximation is certainly valid, and also proves incredibly useful.
There are numerous ways of deriving the result, and further refinements to the approximation to be found elsewhere."/>

    <meta property="og:title" content="Deriving Stirlings Formula" />
<meta property="og:description" content="## A little background to Stirling’s Formula ##
Stirling’s approximation is vital to a manageable formulation of statistical physics and thermodynamics. It vastly simplifies calculations involving logarithms of factorials where the factorial is huge. In statistical physics, we are typically discussing systems of \(10^{22}\) particles. With numbers of such orders of magnitude, this approximation is certainly valid, and also proves incredibly useful.
There are numerous ways of deriving the result, and further refinements to the approximation to be found elsewhere." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mtdevans.com/projects/physics-problems/deriving-stirlings-formula/" /><meta property="article:section" content="projects" />
<meta property="article:published_time" content="2023-02-11T11:24:20+00:00" />
<meta property="article:modified_time" content="2023-02-11T11:24:20+00:00" />


    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'],['\\[', '\\]']],
          processEscapes: false,
        },
        tex: {
          tags: 'ams'
        },
        svg: {
          fontCache: 'global'
        }
      };
    </script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-svg-full.min.js" integrity="sha512-rt6EnxNkuTTgQX2397gLDTao/kZrmdNM4ZO7n89nX6KqOauwSQTGOq3shcd/oGyUc0czxMKBvj+gML8dxX4hAg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    </head>
  <body>
    <header class="app-header">
      <a href="https://mtdevans.com"><img class="app-header-avatar" src="/avatar.jpg" alt="John Doe" /></a>
      <span class="app-header-title">Matt Evans</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/contact/">Contact</a>
             - 
          
          <a class="app-header-menu-item" href="/posts/">Posts</a>
             - 
          
          <a class="app-header-menu-item" href="/projects/main">Projects</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
      </nav>
      <p>An interesting blog about interesting things.</p>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Deriving Stirlings Formula</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Feb 11, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          3 min read
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://mtdevans.com/tags/physics-problems/">physics-problems</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <p>## A little background to Stirling’s Formula ##</p>
<p>Stirling’s approximation is vital to a manageable formulation of statistical physics and thermodynamics. It vastly simplifies calculations involving logarithms of factorials where the factorial is huge. In statistical physics, we are typically discussing systems of \(10^{22}\) particles. With numbers of such orders of magnitude, this approximation is certainly valid, and also proves incredibly useful.</p>
<p>There are numerous ways of deriving the result, and further refinements to the approximation to be found elsewhere. Here is a simple derivation using an analogy with the Gaussian distribution:</p>
<p>## The Formula ##</p>
<p>Derive the Stirling formula:\[\ln(n!) \approx (n+\frac{1}{2})\ln{n} – n + \frac{1}{2}\ln{2\pi}\]</p>
<p>## Let’s Go ##</p>
<p>We begin by calculating the integral \(\int_{0}^{\infty} e^{-x} x^n dx\) (where \(n \ge 0\)) using <a href="https://en.wikipedia.org/wiki/Integration_by_parts">integration by parts</a>.</p>
<p>The formula for integration by parts is:\[\int u(x)v´(x)dx=u(x)v(x)-\int u´(x)v(x)dx\]</p>
<p>Given this situation, it’s normally better to take the infinitely differentiable function as your \(v´(x)\):</p>
<p>\(u(x)=x^n\)          \(u’(x)=nx^{n-1}\)</p>
<p>\(v(x)=-e^{-x}\)     \(v’(x)=e^{-x}\)</p>
<p>Thus we have:</p>
<p>\begin{equation}
\int_{0}^{\infty} x^ne^{-x}dx=[x^n·-e^{-x}]_{0}^{\infty} + n\int_{0}^{\infty}x^{n-1}·e^{-x}dx\label{eq:int1}
\end{equation}</p>
<p>We note that \([x^n·-e^{-x}]_{0}^{\infty}\) is always zero. Labelling the first integral \(g(x)\), the last integral is nothing more than \(n·g(x)|_{n \rightarrow n-1}\). This can be integrated by parts to yield a similar expression but with \(n\) reduced to \(n-1\) (and so on) such that we end up with \(n·(n-1)·(n-2)·&hellip;·(1)=n!\).</p>
<p>\begin{equation}
\int_{0}^{\infty} x^ne^{-x}dx=n! \label{eq:eqeq}
\end{equation}</p>
<p>Take the logarithm of the integrand in \eqref{eq:int1}:\[\ln{e^{-x}x^n} = -x + n\ln{x} =: f(x)\]\[f’(x) \stackrel{!}{=} 0 = -1 + \frac{n}{x}\]\[\Rightarrow x_0=n\]</p>
<p>So we find it has a maximum at \(x_0=n\).</p>
<p><a href="https://en.wikipedia.org/wiki/Taylor_expansion">Expanding</a> \(f(x)\) around \(n\):</p>
<p>\begin{eqnarray}
f(x)&amp;=&amp;-n+n \ln{n}+(-1+\frac{n}{x})|_{x=n}(x-n) + \frac{1}{2!} (\frac{-n}{x^2})|_{x=n}(x-n)^2 + … \nonumber \\
&amp;=&amp;-n+n\ln{n}-\frac{1}{2n}(x-n)^2 \nonumber
\end{eqnarray}</p>
<p>Therefore, \(f(x)=\ln e^{-x} x^n \approx -n  + n\ln n - \frac{1}{2n}(x-n)^2\).</p>
<p>If we take the exponential of \(f(x)\) and integrate, we see we have the same integral we just calculated in \eqref{eq:int1} but in a more useful form:\[\int \exp(f(x))dx=\int e^{-x}x^ndx\]\[\simeq\int \exp(-n + n\ln{n} – \frac{1}{2n}(x-n)^2)\,dx\]</p>
<p>\begin{equation}
=\exp(-n+n\ln{n})\int_{0}^{\infty} \exp(-\frac{(x-n)^2}{2n})dx \stackrel{\eqref{eq:eqeq}}{=} n!
\label{eq:nbang}
\end{equation}</p>
<p>This is calculable by analogy with the <a href="https://en.wikipedia.org/wiki/Gaussian_distribution">Gaussian distribution</a>, where\[P(x)=\frac{1}{\sqrt{2\pi}\sigma}\exp(-\frac{(x-\stackrel{-}{x})^2}{2\sigma^2}).\]</p>
<p>Given the sum of all probabilities \(\int_{-\infty}^{\infty} P(x)dx = 1\), it follows</p>
<p>\[\sqrt{2\pi}\sigma = \int_{-\infty}^{\infty} \exp(-\frac{(x-\stackrel{-}{x})^2}{2\sigma^2})\,dx.\]</p>
<p>If we compare this with \eqref{eq:nbang}, we note \(\sigma^2\) and \(\stackrel{-}{x}\) both translate to \(n\) in our analogy:</p>
<p>\begin{eqnarray}
n!&amp;\simeq&amp;\exp(-n+n\ln{n})\int_{0}^{\infty} \exp(-\frac{(x-n)^2}{2n})\,dx \nonumber \\
&amp;=&amp; \exp(-n+n\ln{n})\sqrt{2\pi n} \label{eq:final}
\end{eqnarray}</p>
<p>Note that the lower bound on the integral has changed from \(-\infty\) to 0. This approximation is justifiable since the peak of the distribution \(n\) is at a point much greater than zero, thus most of the distribution is greater than zero.</p>
<p>Finally, taking the logarithm of \eqref{eq:final},</p>
<p>\begin{eqnarray}
\ln{n!} &amp;\simeq&amp; -n + n\ln{n} + \frac{1}{2}\ln{2\pi n} \nonumber \\
&amp;=&amp;(n+\frac{1}{2})\ln{n}-n+\frac{1}{2}\ln{2\pi}, \nonumber
\end{eqnarray}</p>
<p>we recover what we started with.</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
